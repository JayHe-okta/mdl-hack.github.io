<!DOCTYPE html>
<html>
<head>
    <title>Invoke Wallet</title>
    <!-- Chrome Origin Trial Meta Tag -->
    <meta http-equiv="origin-trial" content="A7LE5BvzN1jb2Lr3+HBjZpyjxyDxxe1bW9wbeZ7ktzwCeppZQEYEkkQF1zJs3cNaP5j4eezA3WidKmVXGsdamgMAAACSeyJvcmlnaW4iOiJodHRwczovL2pheWhlLW9rdGEuZ2l0aHViLmlvOjQ0MyIsImZlYXR1cmUiOiJXZWJJZGVudGl0eURpZ2l0YWxDcmVkZW50aWFscyIsImV4cGlyeSI6MTc0NDc2MTU5OSwiaXNTdWJkb21haW4iOnRydWUsImlzVGhpcmRQYXJ0eSI6dHJ1ZX0=">

    <script>
        async function invokeWallet() {
            try {
                const payload = {
                        "protocol": "preview",
                        "request": {
                            "selector": {
                                "format": ["mdoc"],
                                "doctype": "org.iso.18013.5.1.mDL",
                                "fields": [
                                    {"namespace": "org.iso.18013.5.1", "name": "family_name", "intentToRetain": false},
                                    {"namespace": "org.iso.18013.5.1", "name": "given_name", "intentToRetain": false},
                                    {"namespace": "org.iso.18013.5.1", "name": "age_over_21", "intentToRetain": false}
                                ],
                                "nonce": "R3kjldEu4cWYiUcQeqqmZH502Vl9pob_v99jdNjuTJE="
                            }
                        }
                    }

                // Invoke navigator.credentials.get
                const { data: mdlData } = await navigator.credentials.get({
                    digital: {
                        providers: [{
                            protocol: payload.protocol,
                            request: payload.request
                        }]
                    }
                });

                console.log('Wallet Invoked, Data Retrieved:', mdlData);

                // Display the retrieved data
                document.getElementById('output').textContent = JSON.stringify(mdlData, null, 2);
            } catch (error) {
                console.error('Error invoking wallet:', error);
                document.getElementById('output').textContent = 'Error: ' + error.message;
            }
        }
    </script>
</head>
<body>
    <h1>Invoke Wallet</h1>
    <button onclick="invokeWallet()">Invoke Wallet</button>
    <pre id="output"></pre>
</body>
</html>
